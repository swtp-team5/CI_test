<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Main Page</title>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.5.0/semantic.min.js"></script>
</head>

<body>
<div class="ui vertical menu" id="nav">
    <div class="item">
        <div class="header">Profil</div>
        <div class="menu">
            <a class="item" onclick="showTemplate('profile')">Allgemeiner Bogen</a>
            <a class="item" onclick="showTemplate('history')">Bogen Historie</a>
            <a class="item" onclick="showTemplate('import')">Bogen Import</a>
        </div>
    </div>
    <div class="item">
        <div class="menu">
            <a class="item" onclick="showTemplate('praxis')">Arztpraxen</a>
        </div>
    </div>
    <div class="item">
        <div class="menu">
            <a class="item">Logout</a>
        </div>
    </div>
</div>
<main id="main">
    <!-- Template anzeigen -->
</main>

<script type="text/javascript">
    async function showTemplate(templateId) {
        // get the imported document in templates:
        var templates = document.createElement('template');
        // read external html file
        templates.innerHTML = await (await fetch(getTemplatePath(templateId))).text();

        // get desired content by id
        var template = templates.content.querySelector('#' + templateId);
        var clone = template.content.cloneNode(true);

        // cleanup previous loaded content
        let main = document.querySelector("main");
        while (main.firstChild) {
            main.removeChild(main.firstChild);
        }
        var scriptList = document.querySelector("script");
        scriptList.parentNode.removeChild(scriptList);

        // insert template
        main.appendChild(clone);

        // load respective js file
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        script.src = getJSPath(templateId);

        let scripts = Array
            .from(document.querySelectorAll('script'))
            .map(scr => scr.src);

        if (!scripts.includes(script.src)) {
            document.documentElement.firstChild.appendChild(script);
        }
    }

    function getTemplatePath(templateName) {
        switch (templateName) {
            case "profile":
                return "pages/profile.html";
            case "history":
                return "pages/history.html";
            case "praxis":
                return "pages/praxis.html";
            case "import":
                return "pages/import.html";
            default:
                return "";
        }
    }

    function getJSPath(templateName) {
        switch (templateName) {
            case "profile":
                return "js/profile.js";
            case "import":
                return "js/import.js";
            default:
                return "";
        }
    }
</script>
</body>
</html>